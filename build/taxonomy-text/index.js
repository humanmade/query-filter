(()=>{"use strict";const e=window.wp.blocks,t=JSON.parse('{"UU":"query-filter/taxonomy-text"}'),l=window.wp.i18n,r=window.wp.blockEditor,i=window.wp.components,a=window.ReactJSXRuntime,o=[{label:(0,l.__)("Tag","query-filter"),value:"tag"},{label:(0,l.__)("Category","query-filter"),value:"category"},{label:(0,l.__)("Sort","query-filter"),value:"sort"}],n=[{label:(0,l.__)("Title","query-filter"),value:"title"},{label:(0,l.__)("Description","query-filter"),value:"description"}],s=window.wp.richText,u=window.wp.primitives;var y=(0,a.jsx)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,a.jsx)(u.Path,{d:"M17.5 4v5a2 2 0 0 1-2 2h-7a2 2 0 0 1-2-2V4H8v5a.5.5 0 0 0 .5.5h7A.5.5 0 0 0 16 9V4h1.5Zm0 16v-5a2 2 0 0 0-2-2h-7a2 2 0 0 0-2 2v5H8v-5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v5h1.5Z"})});const f=window.wp.element,p="query-filter/taxonomy-inline-text",x="data-query-filter-text",c={filterType:"tag",valueType:"title",prefix:"",suffix:""},_=[{label:(0,l.__)("Tag","query-filter"),value:"tag"},{label:(0,l.__)("Category","query-filter"),value:"category"},{label:(0,l.__)("Sort","query-filter"),value:"sort"}],T=[{label:(0,l.__)("Title","query-filter"),value:"title"},{label:(0,l.__)("Description","query-filter"),value:"description"}],v=(e,t)=>e.find((e=>e.value===t))?.label||t;(0,s.registerFormatType)(p,{title:(0,l.__)("Taxonomy Text","query-filter"),tagName:"span",className:"taxonomy-text-inline",attributes:{[x]:x},edit:({value:e,onChange:t,isActive:o,activeAttributes:n})=>{const u=(0,f.useMemo)((()=>(e=>{if(!e)return c;try{const t=JSON.parse(e);return{filterType:t.filterType||c.filterType,valueType:t.valueType||c.valueType,prefix:t.prefix||"",suffix:t.suffix||""}}catch(e){return c}})(n?.[x])),[n?.[x]]),[d,h]=(0,f.useState)(!1),[q,g]=(0,f.useState)(u);return(0,f.useEffect)((()=>{g(u)}),[u]),(0,f.useEffect)((()=>{"sort"===q.filterType&&"title"!==q.valueType&&g((e=>({...e,valueType:"title"})))}),[q.filterType,q.valueType]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.RichTextToolbarButton,{icon:y,title:(0,l.__)("Taxonomy Text","query-filter"),onClick:()=>h(!0),isActive:o}),d&&(0,a.jsxs)(i.Modal,{title:(0,l.__)("Dynamic Taxonomy Text","query-filter"),onRequestClose:()=>h(!1),children:[(0,a.jsx)(i.SelectControl,{label:(0,l.__)("Filter Source","query-filter"),value:q.filterType,options:_,onChange:e=>{g((t=>({...t,filterType:e,valueType:"sort"===e?"title":t.valueType})))}}),(0,a.jsx)(i.SelectControl,{label:(0,l.__)("Value Type","query-filter"),value:q.valueType,options:T,disabled:"sort"===q.filterType,onChange:e=>g((t=>({...t,valueType:e})))}),(0,a.jsx)(i.TextControl,{label:(0,l.__)("Prefix Text","query-filter"),value:q.prefix,onChange:e=>g((t=>({...t,prefix:e})))}),(0,a.jsx)(i.TextControl,{label:(0,l.__)("Suffix Text","query-filter"),value:q.suffix,onChange:e=>g((t=>({...t,suffix:e})))}),(0,a.jsx)(i.Flex,{justify:"flex-start",children:(0,a.jsx)(i.FlexItem,{children:(0,a.jsx)(i.Button,{variant:"primary",onClick:()=>{const r={[x]:JSON.stringify(q)},i=e.start===e.end;let a=e;if(i&&!o){const e=(e=>{const t=[(0,l.__)("taxonomy","query-filter"),v(_,e.filterType).toLowerCase()],r="sort"===e.filterType?(0,l.__)("title","query-filter"):v(T,e.valueType);return t.push(r.toLowerCase()),t.join(" ")})(q);a=(0,s.insert)(a,e);const t=a.start,r=t-e.length;a={...a,start:r,end:t}}const n=(0,s.applyFormat)(a,{type:p,attributes:r});t(n),h(!1)},children:(0,l.__)("Apply","query-filter")})})})]})]})}}),(0,e.registerBlockType)(t.UU,{edit:function({attributes:e,setAttributes:t}){const{filterType:s="tag",valueType:u="title",prefix:y="",suffix:f=""}=e,p=(0,r.useBlockProps)({className:`taxonomy-text taxonomy-text--${s}`}),x="sort"===s?(0,l.__)("Selected Sort","query-filter"):"description"===u?(0,l.__)("Selected Term Description","query-filter"):(0,l.__)("Selected Term","query-filter");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.InspectorControls,{children:(0,a.jsxs)(i.PanelBody,{title:(0,l.__)("Display Settings","query-filter"),children:[(0,a.jsx)(i.SelectControl,{label:(0,l.__)("Filter Source","query-filter"),value:s,options:o,onChange:e=>{t({filterType:e,valueType:"sort"===e?"title":u})}}),(0,a.jsx)(i.SelectControl,{label:(0,l.__)("Value Type","query-filter"),value:u,options:n,disabled:"sort"===s,onChange:e=>t({valueType:e})}),(0,a.jsx)(i.TextControl,{label:(0,l.__)("Prefix Text","query-filter"),value:y,onChange:e=>t({prefix:e}),placeholder:(0,l.__)("e.g. Showing results for ","query-filter")}),(0,a.jsx)(i.TextControl,{label:(0,l.__)("Suffix Text","query-filter"),value:f,onChange:e=>t({suffix:e}),placeholder:(0,l.__)("e.g. only","query-filter")})]})}),(0,a.jsx)("span",{...p,children:`${y||""}${x}${f||""}`})]})}})})();